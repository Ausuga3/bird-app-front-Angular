<div class="form-container">
  <h2>{{ pageTitle }}</h2>
  
  @if (error) {
    <div class="alert alert-danger">
      {{ error }}
    </div>
  }
  
  @if (successMessage) {
    <div class="alert alert-success">
      {{ successMessage }}
    </div>
  }
  
  <form [formGroup]="birdForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="commonName">Nombre común *</label>
      <input 
        type="text" 
        id="commonName"
        formControlName="commonName"
        class="form-control" 
        [class.is-invalid]="hasError('commonName')"
      >
      @if (hasError('commonName')) {
        @if (commonName?.errors?.['required']) {
          <div class="invalid-feedback">El nombre común es obligatorio</div>
        }
        @if (commonName?.errors?.['minlength']) {
          <div class="invalid-feedback">El nombre debe tener al menos 3 caracteres</div>
        }
      }
    </div>

    <!-- Nombre científico -->
    <div class="form-group">
      <label for="scientificName">Nombre científico *</label>
      <input 
        type="text" 
        id="scientificName"
        formControlName="scientificName"
        class="form-control" 
        [class.is-invalid]="hasError('scientificName')"
      >
      @if (hasError('scientificName')) {
        <div class="invalid-feedback">El nombre científico es obligatorio</div>
      }
    </div>

    <!-- Familia -->
    <div class="form-group">
      <label for="family">Familia *</label>
      <select 
        id="family"
        formControlName="family"
        class="form-control" 
        [class.is-invalid]="hasError('family')"
      >
        <option [ngValue]="null">Selecciona una familia</option>
        @for (family of birdFamilies; track family) {
          <option [ngValue]="family">{{ family }}</option>
        }
      </select>
      @if (hasError('family')) {
        <div class="invalid-feedback">Selecciona una familia</div>
      }
    </div>

    <!-- Estado de conservación -->
    <div class="form-group">
      <label>Estado de conservación *</label>
      <div class="conservation-options">
        @for (status of conservationStatuses; track status) {
          <div class="form-check">
            <input 
              type="radio" 
              [id]="'status-' + status"
              formControlName="conservationStatus"
              class="form-check-input" 
              [value]="status"
            >
            <label [for]="'status-' + status" class="form-check-label">{{ status }}</label>
          </div>
        }
      </div>
      @if (hasError('conservationStatus')) {
        <div class="text-danger small">Selecciona un estado de conservación</div>
      }
    </div>

    <!-- Notas -->
    <div class="form-group">
      <label for="notes">Notas</label>
      <textarea 
        id="notes"
        formControlName="notes"
        class="form-control" 
        rows="3"
      ></textarea>
    </div>

    <!-- Botones -->
    <div class="form-actions">
      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="isSubmitting"
      >
        {{ isEditMode ? 'Actualizar' : 'Guardar' }}
        @if (isSubmitting) {
          <span class="spinner-border spinner-border-sm ms-2"></span>
        }
      </button>
      
      <button 
        type="button" 
        class="btn btn-secondary"
        (click)="resetForm()"
        [disabled]="isSubmitting"
      >
        {{ isEditMode ? 'Restablecer' : 'Limpiar' }}
      </button>
      
      <button 
        type="button" 
        class="btn btn-outline"
        (click)="goBack()"
        [disabled]="isSubmitting"
      >
        Volver
      </button>
    </div>
  </form>
</div>